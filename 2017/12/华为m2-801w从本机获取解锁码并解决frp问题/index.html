<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Hugo 0.84.1 with theme Tranquilpeak 0.4.8-BETA"><meta name=author content="Yu Huang"><meta name=keywords content="免申请解锁,android"><meta name=description content="使用kingroot可以临时root华为m2-801w，但是重启之后root消失。利用这个临时的root获取nvme，
从而获取到解锁码."><meta property="og:description" content="使用kingroot可以临时root华为m2-801w，但是重启之后root消失。利用这个临时的root获取nvme，
从而获取到解锁码."><meta property="og:type" content="article"><meta property="og:title" content="华为m2 801w从本机获取解锁码并解决frp问题"><meta name=twitter:title content="华为m2 801w从本机获取解锁码并解决frp问题"><meta property="og:url" content="https://blog.huangyu.me/2017/12/%E5%8D%8E%E4%B8%BAm2-801w%E4%BB%8E%E6%9C%AC%E6%9C%BA%E8%8E%B7%E5%8F%96%E8%A7%A3%E9%94%81%E7%A0%81%E5%B9%B6%E8%A7%A3%E5%86%B3frp%E9%97%AE%E9%A2%98/"><meta property="twitter:url" content="https://blog.huangyu.me/2017/12/%E5%8D%8E%E4%B8%BAm2-801w%E4%BB%8E%E6%9C%AC%E6%9C%BA%E8%8E%B7%E5%8F%96%E8%A7%A3%E9%94%81%E7%A0%81%E5%B9%B6%E8%A7%A3%E5%86%B3frp%E9%97%AE%E9%A2%98/"><meta property="og:site_name" content="多学多思考"><meta property="og:description" content="使用kingroot可以临时root华为m2-801w，但是重启之后root消失。利用这个临时的root获取nvme，
从而获取到解锁码."><meta name=twitter:description content="使用kingroot可以临时root华为m2-801w，但是重启之后root消失。利用这个临时的root获取nvme，
从而获取到解锁码."><meta property="og:locale" content="zh-cn"><meta property="article:published_time" content="2017-12-14T00:32:13"><meta property="article:modified_time" content="2017-12-14T00:32:13"><meta property="article:section" content="others"><meta property="article:tag" content="android"><meta property="article:tag" content="linux"><meta name=twitter:card content="summary"><meta name=twitter:site content="@linuxhenhao"><meta name=twitter:creator content="@linuxhenhao"><meta property="og:image" content="https://blog.huangyu.me/images/header.png"><meta property="twitter:image" content="https://blog.huangyu.me/images/header.png"><title>华为m2 801w从本机获取解锁码并解决frp问题</title><link rel=icon href=/favicon.ico><link rel=canonical href=https://blog.huangyu.me/2017/12/%E5%8D%8E%E4%B8%BAm2-801w%E4%BB%8E%E6%9C%AC%E6%9C%BA%E8%8E%B7%E5%8F%96%E8%A7%A3%E9%94%81%E7%A0%81%E5%B9%B6%E8%A7%A3%E5%86%B3frp%E9%97%AE%E9%A2%98/><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin=anonymous><link rel=stylesheet href=/css/style-twzjdbqhmnnacqs0pwwdzcdbt8yhv8giawvjqjmyfoqnvazl0dalmnhdkvp7.min.css></head><body><div id=blog><header id=header data-behavior=4><i id=btn-open-sidebar class="fa fa-lg fa-bars"></i><div class=header-title><a class=header-title-link href=/>多学多思考</a></div><a class=header-right-picture href=/#about><img class=header-picture src=https://blog.huangyu.me/images/header.png alt=作者的图片></a></header><nav id=sidebar data-behavior=4><div class=sidebar-container><div class=sidebar-profile><a href=/#about><img class=sidebar-profile-picture src=https://blog.huangyu.me/images/header.png alt=作者的图片></a><h4 class=sidebar-profile-name>Yu Huang</h4><h5 class=sidebar-profile-bio>学而不思则罔，思而不学则殆</h5></div><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=/categories><i class="sidebar-button-icon fa fa-lg fa-bookmark"></i>
<span class=sidebar-button-desc>分类</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/tags><i class="sidebar-button-icon fa fa-lg fa-tags"></i>
<span class=sidebar-button-desc>标签</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/archives><i class="sidebar-button-icon fa fa-lg fa-archive"></i>
<span class=sidebar-button-desc>归档</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/#about><i class="sidebar-button-icon fa fa-lg fa-question"></i>
<span class=sidebar-button-desc>关于</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=/><i class="sidebar-button-icon fa fa-lg fa-home"></i>
<span class=sidebar-button-desc>首页</span></a></li></ul><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=/#mail><i class="sidebar-button-icon fa fa-lg fa-envelope-o"></i>
<span class=sidebar-button-desc>diwang90#gmail</span></a></li><li class=sidebar-button><a class=sidebar-button-link href=https://github.com/linuxhenhao target=_blank rel=noopener><i class="sidebar-button-icon fa fa-lg fa-github"></i>
<span class=sidebar-button-desc>GitHub</span></a></li></ul><ul class=sidebar-buttons><li class=sidebar-button><a class=sidebar-button-link href=/index.xml><i class="sidebar-button-icon fa fa-lg fa-rss"></i>
<span class=sidebar-button-desc>RSS</span></a></li></ul></div></nav><div id=main data-behavior=4 class=hasCoverMetaIn><article class=post itemscope itemtype=http://schema.org/BlogPosting><div class="post-header main-content-wrap text-left"><h1 class=post-title itemprop=headline>华为m2 801w从本机获取解锁码并解决frp问题</h1><div class="postShorten-meta post-meta"><time itemprop=datePublished datetime=2017-12-14T00:32:13+08:00>十二月 14, 2017</time>
<span>发布在</span>
<a class=category-link href=/categories/others>others</a></div></div><div class="post-content markdown" itemprop=articleBody><div class=main-content-wrap><p>使用kingroot可以临时root华为m2-801w，但是重启之后root消失。利用这个临时的root获取nvme，
从而获取到解锁码.</p><h2 id=获取解锁码>获取解锁码</h2><p>从csdn博客上看到的方法，首先需要使用kingroot或者其他root工具root系统</p><pre><code>$&gt;adb shell  # 主机上
$su
# cd /sdcard
# cat if=/dev/block/platform/hi_mci.0/by-name/nvme of=nvme
$&gt;adb pull /sdcard/nvme # 主机上，带&gt;都表示主机
$&gt;strings nvme | grep WVDEVID -B 1  # 得到16位纯数字解锁码</code></pre><p>拔掉usb线，关机，按住音量减，插入usb线，由于供电，回启动，从而进入fastboot模式。
一般情况，此时在电脑端运行</p><pre><code>fastboot oem unlock &lt;解锁码&gt;</code></pre><p>就可以解决问题了。但是遇到了FRP locked问题，需要先解锁FRP锁才能解锁bootloader。</p><p>FRP全称Factory Reset Protection的目的是解决丢失手机轻易被别人用的问题，直接刷机就可以当新手机用了。
但是有FRP锁，就不能直接刷机使用。更具体的情况未详细了解。</p><p>但是这个平板就是全新的系统，推测原因是国外和国内版本的rom混刷导致的。</p><h2 id=搜索到的解决办法>搜索到的解决办法：</h2><p>1. 网上常见方法， 连续点击7次buildnumber或者叫序列号之后，开启开发者模式，然后找到</p><pre><code>oem unlock enable，开启，之后就可以了。</code></pre><p>2. 但是我在该平板的开发者选项里找不到这个选项。需要首先</p><pre><code>2\.1 进入recovery， 格式化cache，format factory，然后重启。
2\.2 初始化设置，不要开启远程保护&#39;remote protection&#39;(实际我没看到这个选项)
2\.3 进入设置-》账号-》google，登陆
2\.4 进入开发者选项，应该就oem unlock选项了。</code></pre><p>上述方法均对我的情况无效。由于猜测是混刷国内外rom导致的，由于购买的是海外版，所以决定刷回
海外版。但是EMUI4.0之后，无法在设置->系统更新中选取本地更新包更新。只能用同时按住音量+-键
的同时开机的三键强刷方式更新系统。</p><p>值得注意的是，竟然不能在连着usb线的同时强刷，否则会卡在5%正在安装。</p><h2 id=具体过程>具体过程：</h2><p>1、刷B213退回B019中间包（花粉论坛上有）:由于是欧版刷的国内包B213，发现直接刷欧版或者国际版
的B213失败（<a href=https://boycracked.com/2017/05/05/official-huawei-mediapad-m2-8-0-m2-801w-stock-rom-firmware/>国外固件系列地址</a>）
，所以刷回中文B019然后强刷国际版B213。
2、安装google play，登陆账户，然后不论是系统设置还是google设置都关闭“找回”功能。
3、安装kingroot完成root。
4、重启到bootloader，也就是fastboot界面，发现莫名其妙的就变成PHONE UNLocked了，不知道是
上述的2还是3导致的。然而frp lock
还是存在，所以没法用fastboot flash方式刷机。不过bootloader已经解了。
4、在正常系统中B019, 通过kingroot root成功， 然后使用adb shell，直接将twrp写入recovery分区，
然后由于bootloader锁没有了，就可以随意刷了。当然也就可以刷入欧版的recovery回复到我海外版
的mediapad的官方固件。</p><pre><code>host$&gt;adb push twrp.img /data/local/tmp/recovery.img
host$&gt;adb shell
android&gt;$ su # 记得在界面中确认允许权限申请
android&gt;# dd if=/data/loca/tmp/recovery.img \
             of=/dev/block/platform/hi_mci.0/by-name/recovery</code></pre><h2 id=从官方updateapp中提取recoveryimg>从官方UPDATE.APP中提取recovery.img</h2><p>xda论坛上有个splitupdate.pl的脚本，也有huawei-extractor.exe的可安装软件，都可以方便的
将UPDATE.APP中的文件提取出来。通过perl脚本，提取到了RECOVERY.img。</p><p>使用file命令查看该RECOVER.img发现类型是<code>data</code>，而对于twrp或者从别的地方拿到的recovery
的类型却是<code>Android bootimg</code>，采用vim分别打开两种类型的recover，用<code>%!xxd</code>转化为16进制，
发现从UPDATE.APP中提取出来的recovery.img有一个偏移之后，和类型为<code>Android bootimg</code>的
recovery就一模一样了，具体的偏移量需要用vim打开16进制后观察得到。使用dd得到同为<code>android bootimg</code>
类型的recovery</p><pre><code>dd if=./RECOVERY.img of=./androidbootimg-recovery.img bs=16 skip=256
# 小技巧，vim 用xxd转换的16进制模式，每行是16字节，看行号就能知道要跳过多少内容
# 完成之后用file命令查看一下
$file androidbootimg-recovery.img
androidbootimg-recovery.img: Android bootimg xxxx # 成功</code></pre><p>PS:</p><p>进入工程模式方法：在计算器中，横屏模式下，输入()()2846579()()=，可以进行“工厂级恢复恢复出厂设置”，
或者说“低级格式化”。</p><p><code>fastboot oem frp-unlock FRPKEY</code>可以解锁frp，但是需要这个key，不想买所以没弄。</p><p>PPS:</p><p>果然是瞎折腾，由于混刷国内外rom导致的FRP，想刷回国外版，但是在recovery界面提示“版本信息校验失败”，
无法完成。由于刷回了b019, 所以可以root并重启后root仍然存在。其实到这里，折腾这件事的初衷就可以达到了，
通过adb shell进入系统，用dd写入想要刷如的第三方recovery，并且重启也确实可以进入了。那么就可以
刷入gapps和xposed以及supersu这些东西了。</p><p>但是不作不死，看着fastboot界面的FRP lock就不爽，于是想直接用dd将UPDATE.app里解出来的分区一个个
的写进去。但是忘了极为重要的事情——解出来的分区并不是最终写入的内容，前面有一定长度的头文件，就像
上面说的recovery.img的处理部分所说的。结果就是写入的各个分区镜像都是错误内容， 然后开不了机变砖了。
电源键按了毫无反应，也没法强刷，很可能是uboot（类似）或者主板新片坏了。网上查换主板1400, 加上屏幕
原来就摔裂了，干脆扔掉了。。。。</p></div></div><div id=post-footer class="post-footer main-content-wrap"><div class=post-footer-tags><span class="text-color-light text-small">标签</span><br><a class="tag tag--primary tag--small" href=/tags/android/>android</a>
<a class="tag tag--primary tag--small" href=/tags/linux/>linux</a></div><div class=post-actions-wrap><nav><ul class="post-actions post-action-nav"><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=/2017/12/%E7%99%BE%E5%BA%A6%E7%BD%91%E7%9B%98ari2c%E5%8A%A0%E9%80%9F%E4%B8%8B%E8%BD%BD/ data-tooltip=百度网盘ari2c加速下载><i class="fa fa-angle-left"></i>
<span class="hide-xs hide-sm text-small icon-ml">下一篇</span></a></li><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=/2017/12/hugo-katex-support/ data-tooltip="Hugo Katex Support"><span class="hide-xs hide-sm text-small icon-mr">上一篇</span>
<i class="fa fa-angle-right"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href=#btn-open-shareoptions><i class="fa fa-share-alt"></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#><i class="fa fa-list"></i></a></li></ul></div></div></article><footer id=footer class=main-content-wrap><span class=copyrights>&copy; 2021 Yu Huang. All Rights Reserved</span></footer></div><div id=bottom-bar class=post-bottom-bar data-behavior=4><div class=post-actions-wrap><nav><ul class="post-actions post-action-nav"><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=/2017/12/%E7%99%BE%E5%BA%A6%E7%BD%91%E7%9B%98ari2c%E5%8A%A0%E9%80%9F%E4%B8%8B%E8%BD%BD/ data-tooltip=百度网盘ari2c加速下载><i class="fa fa-angle-left"></i>
<span class="hide-xs hide-sm text-small icon-ml">下一篇</span></a></li><li class=post-action><a class="post-action-btn btn btn--default tooltip--top" href=/2017/12/hugo-katex-support/ data-tooltip="Hugo Katex Support"><span class="hide-xs hide-sm text-small icon-mr">上一篇</span>
<i class="fa fa-angle-right"></i></a></li></ul></nav><ul class="post-actions post-action-share"><li class="post-action hide-lg hide-md hide-sm"><a class="post-action-btn btn btn--default btn-open-shareoptions" href=#btn-open-shareoptions><i class="fa fa-share-alt"></i></a></li><li class=post-action><a class="post-action-btn btn btn--default" href=#><i class="fa fa-list"></i></a></li></ul></div></div><div id=share-options-bar class=share-options-bar data-behavior=4><i id=btn-close-shareoptions class="fa fa-close"></i><ul class=share-options></ul></div><div id=share-options-mask class=share-options-mask></div></div><div id=about><div id=about-card><div id=about-btn-close><i class="fa fa-remove"></i></div><img id=about-card-picture src=https://blog.huangyu.me/images/header.png alt=作者的图片><h4 id=about-card-name>Yu Huang</h4><div id=about-card-bio>学而不思则罔，思而不学则殆</div><div id=about-card-job><i class="fa fa-briefcase"></i><br>想做程序猿</div><div id=about-card-location><i class="fa fa-map-marker"></i><br>Dream road</div></div></div><div id=cover style=background-image:url(https://blog.huangyu.me/images/cover.jpg)></div><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin=anonymous></script><script src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin=anonymous></script><script src=/js/script-pcw6v3xilnxydl1vddzazdverrnn9ctynvnxgwho987mfyqkuylcb1nlt.min.js></script><script lang=javascript>window.onload=updateMinWidth,window.onresize=updateMinWidth,document.getElementById("sidebar").addEventListener("transitionend",updateMinWidth);function updateMinWidth(){var b=document.getElementById("sidebar"),a=document.getElementById("main"),c,d,e;a.style.minWidth="",c=getComputedStyle(a).getPropertyValue("min-width"),d=getComputedStyle(b).getPropertyValue("width"),e=getComputedStyle(b).getPropertyValue("left"),a.style.minWidth=`calc(${c} - ${d} - ${e})`}</script><script>$(document).ready(function(){hljs.configure({classPrefix:'',useBR:!1}),$('pre.code-highlight > code, pre > code').each(function(b,a){$(this).hasClass('codeblock')||$(this).addClass('codeblock'),hljs.highlightBlock(a)})})</script></body></html>