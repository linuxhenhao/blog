+++
title = "百度网盘ari2c加速下载"
date = 2017-12-24T15:56:43+08:00
tags = ["百度网盘", "加速"]
categories = ['network']
keywords = ['百度云','aria2c', '加速']
markup = "mmark"
+++
百度云下载时候的限速是众所周知的，不买vip就限速，就是这么任性。但是挡不住程序员们，有人
就通过分析得到了获取百度云实际链接的方法，通过实际链接+多线程下载的方式可以获取到较好速度。
<!--more-->

话不多说直奔主题：   
0、想要加速下载的文件首先要转存到自己的百度云空间。   
1、获取文件实际链接的脚本，[greasyfork](https://greasyfork.org)上关键词搜索。   
2、在网页上由于上一步的脚本多出来了一个按钮可以得到文件的实际下载链接，复制之。   
3、右键`检查元素`获取到浏览器对百度云的cookies，用于aria2c下载，否则百度云服务器会拒绝。   
4、aria2c多线程下载：

    aria2c -j 60 -x 60 -s 60 --header="Cookie:复制来的cookie" -o 保存文件名 \
                      "实际下载链接"
    # -j 指定aria2c最多的下载线程数
    # -x 指定对同一服务器建立连接数
    # -s 指定对当个文件最多下载线程数
    # 我们只用该命令下载一个文件，所以-j指定的是这单个文件最大下载连接数，-x -s设置
    # 该文件从这一个服务器建立60个连接同时下载。

***PS： aria2c小修改***   

aria2c默认编译的情况下，-x选项的值只能介于1-16之间，百度云的限速基本
是一个连接100k左右，如果你的带宽也就是1.6m下载速度不错了，那就无需折腾。如果想要更大的下
在速率，比如60个连接，速度5.6M左右，就需要更改源码的16到100或者更多，重新编译。

源码文件中的`OptionHandlerFactory.cc`:

    OptionHandler* op(new NumberOptionHandler(PREF_MAX_CONNECTION_PER_SERVER,
                                              TEXT_MAX_CONNECTION_PER_SERVER,
                                              "1", 1, 100, 'x'));
                                                # 这里将原来的16改为100，实际用的是
                                                # int32，所以可以设到更大，但是100差
                                                # 不多了
